\section{Optimizing Object Tracking}
\label{sec:methods/section_b}

Object tracking pipeline consists of YOLOv3 and SORT and using the software from \cite{jocher_ultralyticsyolov3_2021} and \cite{abewley_abewleysort_2021}, there are 6 parameters needed to be set to run the object tracking. To run these software, we have to set the suitable parameters; hence, we set the appropriate parameters by optimizing the detection performance for YOLOv3 and tracking performance for SORT. The following parameters that need to be set for YOLOv3 are as follows.
\begin{itemize}
    \item \textbf{Image size}: This parameter is the image resolution for inference of object detection in the YOLOv3 model.
    \item \textbf{Confidence threshold}: This parameter indicates the threshold of object detection. The higher the threshold, the object detector will be less likely to detect the target but fewer mistakes in detection.
    \item \textbf{IOU threshold for Non-maximum suppression (NMS)}: NMS prevents multiple detections on the same target \cite{redmon_you_2016}. IOU threshold is used in applying NMS in our YOLOv3.
\end{itemize}
For the parameter of image size, any input image will be resized to this resolution for prediction. Since the resolution of 640x640 was used during the training of the pre-trained network weight, we speculated that the detection performance would be the most optimized in this particular resolution during the inference in testing samples; therefore, we chose 640x640 as image size.

For the confidence threshold and IOU threshold for NMS, we apply the grid search method to determine the suitable values. To tune these parameters, we run YOLOv3 and SORT on the selected training sequence of Class C PartyScene. Since both parameters range from 0 to 1, we run the detector with a step size of 0.05 and plot the detection performance $F1$ over different confidence threshold and IOU threshold as shown in Figure \ref{fig:optimizing_detector}.
\input{tex/figures/optimizing_detector}
The table and plot in this figure show that there are optimal F1 scores over different confidence and IOU threshold values. The table with the plot shows that the detector achieved the same F1 score over different IOU thresholds at a confidence threshold of 0.25. Since the higher the IOU threshold we choose, it makes the detector more careful in detection; in other words, we expect to see less FP and more FN. Therefore, we chose the confidence threshold of 0.25 and the IOU threshold for NMS to be 0.55.

For optimizing the tracking performance of SORT, the following input parameters are listed \cite{bewley_simple_2016}.
\begin{itemize}
    \item \textbf{Max age}: As T\textsubscript{lost} explained in Chapter \ref{sec:background/section_b}, the value of maximum age determines the maximum number of frames to be alive while no objects are detected before the trajectory termination.
    \item \textbf{Min hits}: Minimum number of necessary detection before the trajectory creation and its assignment initialization.
    \item \textbf{IOU threshold}: Minimum IOU threshold for object matching. IOU less than this threshold indicates that the object does not overlap enough with the ground truth, so identity will not be assigned, but an assignment occurs when IOU is higher than the threshold.
\end{itemize}
For the max age, we chose the value of 1 because \citeauthor{bewley_simple_2016} justified this value by the two reasons; the constant linear motion in the Kalman filter framework does not cover the true dynamics where the non-linear motion exists, and SORT does not deal with the object re-identification \cite{bewley_simple_2016}. 

For the min hits and IOU threshold, we run SORT on the training sequence of Class C PartyScene for both parameters from 0.1 to 0.9 at a step size of 0.05 as a grid search method. To optimize these parameters, we have tested on both tracking cases: single class of "person" tracking and "all" object classes for a more general case as multiple classes tracking, which includes more discontinuity of detection. we have chosen "person" for the tracking in this tuning since we considered the "person" class is "cleaner" than other classes because the objects are mostly present in the frames without discontinuity of detection. For the "all" object classes tracking case, SORT will track all available classes in the ground truths. Figure \ref{fig:optimizing_tracker_0} shows the result of "person" class tracking. The evaluation based on MOTA over different min hits and IOU threshold is plotted, and the highest scores are shown in the table. Although there is no single metric that has been agreed to evaluate the tracking performance, MOTA is the most popular metric in MOT and serves as a good indicator for the general tracking performance \cite{bernardin_evaluating_2008} \cite{milan_mot16_2016}. Therefore, we started optimizing based on MOTA instead of solving multiple objective optimization problem for all the performance metrics. This result indicates that for the "person" tracking, the MOTA score is optimal at min hits of 2 and the IOU threshold from 0.10 to 0.40. Figure \ref{fig:optimizing_tracker_all} shows that min hits of 9 and IOU threshold from 0.10 to 0.40 achieve the optimal performance.
\input{tex/figures/optimizing_tracker}
For selecting the IOU threshold, we chose 0.4 since both tracking cases give the best MOTA score at the IOU threshold up to 0.4, and the higher the IOU threshold gives the more careful design in tracking. For the min hits, we chose the value of 5, between 2 and 9. 

As we have selected the values of parameters based on MOTA: max age of 1, min hits of 5, and IOU threshold of 0.4, the further justification for other metrics are shown in the Appendix \ref{sec:appendix/section_a}. The selected values of parameters in YOLOv3 and SORT are summarized in Table \ref{tab:parameters}.
\input{tex/tables/parameters}